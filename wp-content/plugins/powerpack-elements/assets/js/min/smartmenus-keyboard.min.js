!function(t){"function"==typeof define&&define.amd?define(["jquery","smartmenus"],t):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(m){function v(t){return t.find("> li > a:not(.disabled), > li > :not(ul) a:not(.disabled)").eq(0)}function r(t){return t.find("> li > a:not(.disabled), > li > :not(ul) a:not(.disabled)").eq(-1)}function b(t,a){var e=t.nextAll("li").find("> a:not(.disabled), > :not(ul) a:not(.disabled)").eq(0);return a||e.length?e:v(t.parent())}function f(t,a){var e=t.prevAll("li").find("> a:not(.disabled), > :not(ul) a:not(.disabled)").eq(/^1\.8\./.test(m.fn.jquery)?0:-1);return a||e.length?e:r(t.parent())}return m.fn.focusSM=function(){return this.length&&this[0].focus&&this[0].focus(),this},m.extend(m.SmartMenus.Keyboard={},{docKeydown:function(t){var a=t.keyCode;if(/^(37|38|39|40)$/.test(a)){var e=m(this),s=e.data("smartmenus"),i=m(t.target);if(s&&i.is("a")&&s.handleItemEvents(i)){var d,c=i.closest("li"),n=c.parent(),o=n.dataSM("level");switch(e.hasClass("sm-rtl")&&(37==a?a=39:39==a&&(a=37)),a){case 37:s.isCollapsible()||(2<o||2==o&&e.hasClass("sm-vertical")?s.activatedItems[o-2].focusSM():e.hasClass("sm-vertical")||f((s.activatedItems[0]||i).closest("li")).focusSM());break;case 38:s.isCollapsible()?(1<o&&(d=v(n)).length&&i[0]==d[0]?s.activatedItems[o-2]:f(c)).focusSM():1==o&&!e.hasClass("sm-vertical")&&s.opts.bottomToTopSubMenus?(!s.activatedItems[0]&&i.dataSM("sub")&&(s.opts.showOnClick&&(s.clickActivated=!0),s.itemActivate(i),i.dataSM("sub").is(":visible"))&&(s.focusActivated=!0),s.activatedItems[0]&&s.activatedItems[0].dataSM("sub")&&s.activatedItems[0].dataSM("sub").is(":visible")&&!s.activatedItems[0].dataSM("sub").hasClass("mega-menu")&&r(s.activatedItems[0].dataSM("sub")).focusSM()):(1<o||e.hasClass("sm-vertical"))&&f(c).focusSM();break;case 39:s.isCollapsible()||(1==o&&e.hasClass("sm-vertical")?(!s.activatedItems[0]&&i.dataSM("sub")&&(s.opts.showOnClick&&(s.clickActivated=!0),s.itemActivate(i),i.dataSM("sub").is(":visible"))&&(s.focusActivated=!0),s.activatedItems[0]&&s.activatedItems[0].dataSM("sub")&&s.activatedItems[0].dataSM("sub").is(":visible")&&!s.activatedItems[0].dataSM("sub").hasClass("mega-menu")&&v(s.activatedItems[0].dataSM("sub")).focusSM()):1!=o&&(!s.activatedItems[o-1]||s.activatedItems[o-1].dataSM("sub")&&s.activatedItems[o-1].dataSM("sub").is(":visible")&&!s.activatedItems[o-1].dataSM("sub").hasClass("mega-menu"))||e.hasClass("sm-vertical")?s.activatedItems[o-1]&&s.activatedItems[o-1].dataSM("sub")&&s.activatedItems[o-1].dataSM("sub").is(":visible")&&!s.activatedItems[o-1].dataSM("sub").hasClass("mega-menu")&&v(s.activatedItems[o-1].dataSM("sub")).focusSM():b((s.activatedItems[0]||i).closest("li")).focusSM());break;case 40:if(s.isCollapsible())if(s.activatedItems[o-1]&&s.activatedItems[o-1].dataSM("sub")&&s.activatedItems[o-1].dataSM("sub").is(":visible")&&!s.activatedItems[o-1].dataSM("sub").hasClass("mega-menu")&&(d=v(s.activatedItems[o-1].dataSM("sub"))).length)d.focusSM();else if(1<o&&(d=r(n)).length&&i[0]==d[0]){for(var l=s.activatedItems[o-2].closest("li"),u=null;l.is("li")&&!(u=b(l,!0)).length;)l=l.parent().parent();(u.length?u:v(e)).focusSM()}else b(c).focusSM();else 1!=o||e.hasClass("sm-vertical")||s.opts.bottomToTopSubMenus?(1<o||e.hasClass("sm-vertical"))&&b(c).focusSM():(!s.activatedItems[0]&&i.dataSM("sub")&&(s.opts.showOnClick&&(s.clickActivated=!0),s.itemActivate(i),i.dataSM("sub").is(":visible"))&&(s.focusActivated=!0),s.activatedItems[0]&&s.activatedItems[0].dataSM("sub")&&s.activatedItems[0].dataSM("sub").is(":visible")&&!s.activatedItems[0].dataSM("sub").hasClass("mega-menu")&&v(s.activatedItems[0].dataSM("sub")).focusSM())}t.stopPropagation(),t.preventDefault()}}}}),m(document).on("keydown.smartmenus","ul.pp-advanced-menu, ul.pp-advanced-menu:not([data-sm-skip])",m.SmartMenus.Keyboard.docKeydown),m.extend(m.SmartMenus.prototype,{keyboardSetHotkey:function(t,i){var a=this;m(document).on("keydown.smartmenus"+this.rootId,function(e){var s;t==e.keyCode&&(s=!0,i&&("string"==typeof i&&(i=[i]),m.each(["ctrlKey","shiftKey","altKey","metaKey"],function(t,a){if(0<=m.inArray(a,i)&&!e[a]||m.inArray(a,i)<0&&e[a])return s=!1})),s)&&(v(a.$root).focusSM(),e.stopPropagation(),e.preventDefault())})}}),m});